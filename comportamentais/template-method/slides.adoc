:revealjsdir: https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.8.0/
//:revealjsdir: https://cdnjs.com/libraries/reveal.js/3.8.0
:revealjs_slideNumber: true
:revealjs_navigationMode: linear

:source-highlighter: highlightjs
:icons: font
:allow-uri-read:
:stylesheet: ../../adoc-golo.css
:customcss: ../../slides-base.css
:numbered:
:toc: left
:toc-title: Sum√°rio
:toclevels: 5

:proj-boleto-template: retorno-boleto-template/src/main/java/com/manoelcampos/retornoboleto/
:proj-boleto-strategy: ../strategy/retorno-boleto/src/main/java/com/manoelcampos/retornoboleto/LeituraRetornoBancoBrasil.java
:proj-boleto-template-strategy: retorno-boleto-template-and-strategy/src/main/java/com/manoelcampos/retornoboleto/
:proj-boleto-funcional: retorno-boleto-template-funcional/src/main/java/com/manoelcampos/retornoboleto/

ifdef::env-github[]
//Exibe √≠cones para os blocos como NOTE e IMPORTANT no GitHub

:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

:chapter-label:
:listing-caption: Listagem
:figure-caption: Figura

//Transi√ß√£o para todos os slides // none/fade/slide/convex/concave/zoom
//:revealjs_transition: 'zoom'

//https://github.com/hakimel/reveal.js#theming
:revealjs_theme: league

= Padr√£o de Projetos Template Method image:images/template-large.png[link=https://www.flaticon.com/authors/monkik]: Quase tudo que precisa saber (com exemplos em Java 8+) üôåüèº

Prof. Manoel Campos https://about.me/manoelcampos

[transition=zoom]
== Categoria

Padr√£o de projeto Comportamental image:../../images/behaviour.gif[]

[transition=fade]
== Defini√ß√£o

include::README.adoc[tag=definicao]

image:../../images/ucpp.jpg[size=contain]

[transition=zoofadem]
== Aplicabilidade

Pode ser aplicado quando:

[%step]
include::README.adoc[tag=aplicabilidade]

[transition=zoom]
== Modelagem do Template Method

=== !

image::images/template-method-base.png[background, size=contain]

[transition=zoom]
== Mas consigo fazer isso apenas com heran√ßa e sobrescrita de m√©todo ü§®

include::README.adoc[tag=method-override]

[transition=zoom, background-opacity=0.4]
== Princ√≠pios utilizados

image::../../images/recommendations.jpg[background, size=contain, text=https://www.smart-energy.com, link=https://www.smart-energy.com/industry-sectors/smart-energy/five-key-recommendations-for-the-sustainable-energy-sector-growth-in-mena/]

[%step]
- https://en.wikipedia.org/wiki/Open‚Äìclosed_principle[Open/Closed Principle (OCP)]
- https://en.wikipedia.org/wiki/Single_responsibility_principle[Single Responsibility Principle (SRP)]

[transition=zoom]
== !

- **Exemplo**: Leitura de arquivos de retorno de boletos banc√°rios, de novo üòÖ.

image::images/boleto-iugu-lp.png[background]

== Problema da vers√£o com Strategy

=== !

[source,java,linenums]
----
include::{proj-boleto-strategy}[tag=class-start]
                /* Omitidos campos por simplifica√ß√£o */
include::{proj-boleto-strategy}[tag=class-end]
----

== Modelagem do Retorno Boleto com Template Method

image::images/template-method-boleto.png[background, size=contain]

== Implementa√ß√£o do Retorno Boleto com Template Method

=== Super classe com o m√©todo Template

[source,java,linenums]
----
include::{proj-boleto-template}/ProcessadorBoletos.java[tag=class-start]
include::{proj-boleto-template}/ProcessadorBoletos.java[tag=template-method]
include::{proj-boleto-template}/ProcessadorBoletos.java[tag=primitive-operation]
include::{proj-boleto-template}/ProcessadorBoletos.java[tag=class-end]
----

=== Sub classe com opera√ß√µes primitivas (1 opera√ß√£o neste caso)

[source,java,linenums]
----
include::{proj-boleto-template}/LeituraRetornoBancoBrasil.java[tag=class-start]
include::{proj-boleto-template}/LeituraRetornoBancoBrasil.java[tag=primitive-operation-start]
        /* Omitidos campos por simplifica√ß√£o */
include::{proj-boleto-template}/LeituraRetornoBancoBrasil.java[tag=primitive-operation-end]
include::{proj-boleto-template}/LeituraRetornoBancoBrasil.java[tag=class-end]
----

=== Usando a implementa√ß√£o do BB image:images/bb.png[]

[source,java,linenums]
----
ProcessadorBoletos processador = new LeituraRetornoBancoBrasil();
String nomeArquivo = "caminho-arquivo-retorno-boleto-banco-brasil.csv";
processador.processar(nomeArquivo);
----

[transition=fade]
== Compara√ß√£o com o Strategy

[%step]
- Strategy https://en.wikipedia.org/wiki/Composition_over_inheritance[favorece composi√ß√£o no lugar de heran√ßa] üëç
- Template Method usa apenas heran√ßa: perda da flexibilidade e dinamismo do Strategy üòí
- Mas removeu a duplica√ß√£o do c√≥digo e dividiu mais ainda as responsabilidades üôåüèº

[transition=fade]
== !

**QUE TAL JUNTAR O PODER DOS PADR√ïES?**

**Strategy + Template Method**

image::images/power-union.jpg[background, size=contain, link="http://iberapa.com/sustainability/"]

=== !

image::images/template-method-strategy-boleto.png[background, size=contain]

=== Implementa√ß√£o do Retorno Boleto com Strategy + Template Method

=== !

[source,java,linenums]
----
include::{proj-boleto-template-strategy}/ProcessadorBoletos.java[tag=class-start]
include::{proj-boleto-template-strategy}/ProcessadorBoletos.java[tag=class-end]
----

=== !

[source,java,linenums]
----
include::{proj-boleto-template-strategy}/LeituraRetornoBancoBrasil.java[tag=class-start]
        /* Omitidos campos por simplifica√ß√£o */
include::{proj-boleto-template-strategy}/LeituraRetornoBancoBrasil.java[tag=class-end]
----

=== Usando a nova implementa√ß√£o com Strategy + Template Method

[source,java,linenums]
----
ProcessadorBoletos processador = 
        new ProcessadorBoletos(new LeituraRetornoBancoBrasil());
String nomeArquivo = "caminho-arquivo-retorno-boleto-banco-brasil.csv";
processador.processar(nomeArquivo);
----

== Modelagem do Template Method com Programa√ß√£o Funcional em Java 8+ 

s√≥ isso? üòØ

image::images/template-method-funcional.png[]

== Retorno Boleto com Template Method e Programa√ß√£o Funcional em Java 8+

=== !

image::images/template-method-boleto-funcional.png[background, size=contain]

=== Implementa√ß√£o do Retorno Boleto com Template Method e Programa√ß√£o Funcional em Java 8+

=== !

[source,java,linenums]
----
include::{proj-boleto-funcional}/ProcessadorBoletos.java[tag=class-start]
include::{proj-boleto-funcional}/ProcessadorBoletos.java[tag=class-end]
----

=== !

[source,java,linenums]
----
include::{proj-boleto-funcional}/LeituraRetorno.java[tag=class-start]
include::{proj-boleto-funcional}/LeituraRetorno.java[tag=method-start]
        /* Omitidos campos por simplifica√ß√£o */
include::{proj-boleto-funcional}/LeituraRetorno.java[tag=method-end]
----

=== Usando a implementa√ß√£o Funcional

[source,java,linenums]
----
ProcessadorBoletos processador =
        new ProcessadorBoletos(LeituraRetorno::processarLinhaBancoBrasil);
String nomeArquivo = "caminho-arquivo-retorno-boleto-banco-brasil.csv";
processador.processar(nomeArquivo);
----

== O que houve com o Strategy na implementa√ß√£o Funcional? 

(revendo a modelagem)

=== !

image::images/template-method-boleto-funcional.png[background, size=contain]

== !

**Refer√™ncias**

- ‚ÄúPadr√µes de Projeto: Solu√ß√µes reutiliz√°veis de software orientado a objetos‚Äù. 2006 [GoF].
- ‚ÄúUse a Cabe√ßa! Padr√µes de Projetos‚Äù, 2008 [UCPP].
- ‚ÄúAgile software development principles, patterns, and practices‚Äù, Robert Martin, 2011. [ASDPPP]
- http://refactoring.guru (agora tamb√©m em Portugu√™s)
