:imagesdir: images
:numbered:
:icons: font

ifdef::env-github[]
//Exibe Ã­cones para os blocos como NOTE e IMPORTANT no GitHub

:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

= Objeto de ConfiguraÃ§Ã£o Singleton com CDI no Quarkus (link:https://kinolien.github.io/gitzip/?download=/manoelcampos/padroes-projetos/tree/master/criacionais/singleton/config-singleton-web-cdi[zip])

Este projeto usa o framework de injeÃ§Ã£o de dependÃªncia CDI para implementar um objeto de configuraÃ§Ã£o Singleton por meio de uma simples anotaÃ§Ã£o `@ApplicationScoped`. Este Ã© um projeto web desenvolvido com o framework http://quarkus.io[Quarkus]. CDI e Quarkus jÃ¡ foram tratados em detalhes no projeto link:https://github.com/manoelcampos/quarkus-cep-services[cep-service].

== Requisitos

== Requisitos

- JDK 8 ou 11
- Maven 3.6.3 ou superior

Mesmo as versÃµes mais atuais do NetBeans vÃªm com versÃµes antigas do Maven que nÃ£o irÃ¡ funcionar.

O maven pode ser instalado, por exemplo em distribuiÃ§Ãµes Linux baseadas em Debian, com:

[source,bash]
----
sudo apt-get install maven
----

No Windows, pode-se baixar um arquivo `apache-maven-x.x.x-bin.zip` em https://maven.apache.org/download.cgi. VocÃª tambÃ©m pode configurar o https://docs.microsoft.com/en-us/windows/wsl/install-win10[Windows Subsystem for Linux] e assim poderÃ¡ baixar aplicaÃ§Ãµes usando o mesmo comando Linux acima.

No NetBeans entÃ£o Ã© possÃ­vel indicar que deseja-se utilizar uma versÃ£o do Maven instalada no sistema, no lugar de usar a que vem com o NetBeans. 
Para isto, acesse as preferÃªncias do NetBeans, depois a aba Java >> Maven e informe o caminho do comando "mvn" no campo "Maven Home".

== Executar o Projeto

VocÃª pode iniciar o servidor com sua aplicaÃ§Ã£o de diferentes maneiras:

- Usando o script mvnw incluÃ­do durante a criaÃ§Ã£o do projeto: `./mvnw compile quarkus:dev`. O comando deve ser executado na raiz do projeto que rodar.
- Ou simplesmente clicando no botÃ£o Play em IDEs como o NetBeans, pois foi incluÃ­do o plugin maven exec para executar o comando acima mais facilmente.

==== Atualizando o projeto sem reiniciar o servidor

Bem, atualizar o projeto no servidor em execuÃ§Ã£o e ver as alteraÃ§Ãµes que vocÃª fez na sua aplicaÃ§Ã£o Ã© realmente complicado com o Quarkus: vocÃª precisa apenas salvar o projeto e boom: normalmente em menos de 1 segundo a aplicaÃ§Ã£o estarÃ¡ rodando com as novas alteraÃ§Ãµes ğŸ˜±ğŸš€ğŸ˜.

NÃ£o Ã© Ã  toa que o slogan do Quarkus Ã© "Supersonic Subatomic Java".

==== Acessando a aplicaÃ§Ã£o

Se vocÃª estiver habituado a usar servidores como o GlassFish no NetBeans,
sabe que ao clicar no botÃ£o Play, o projeto Ã© compilado e executado,
abrindo o navegador automaticamente.
Usando o Quarkus isso nÃ£o ocorrerÃ¡.
VocÃª deve abrir o navegador vocÃª mesmo. Neste caso, a aplicaÃ§Ã£o estarÃ¡ disponÃ­vel
em http://localhost:8080.
Observe que nÃ£o hÃ¡ um caminho adicional com o nome da aplicaÃ§Ã£o no final da URL,
pois a aplicaÃ§Ã£o executa na raiz do servidor.

== Detalhes dos Projetos

Estamos utilizando o framework CDI da plataforma Java para injeÃ§Ã£o de dependÃªncias,
neste caso para injetar um instÃ¢ncia Ãºnica (Singleton) de um objeto
de configuraÃ§Ã£o, usando a anotaÃ§Ã£o `@ApplicationScoped`.
Desta forma, tal objeto serÃ¡ Ãºnico para todos os usuÃ¡rios da aplicaÃ§Ã£o.

== ReferÃªncias

- https://quarkus.io/guides/config[Microprofile Config no Quarkus]
- https://quarkus.io/guides/openapi-swaggerui[DocumentaÃ§Ã£o de APIs REST com Swagger (OpenAPI) no Quarkus]
