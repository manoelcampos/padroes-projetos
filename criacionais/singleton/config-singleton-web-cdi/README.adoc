:imagesdir: images
:numbered:
:icons: font

ifdef::env-github[]
//Exibe √≠cones para os blocos como NOTE e IMPORTANT no GitHub

:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

= Objeto de Configura√ß√£o Singleton com CDI no Quarkus (link:https://kinolien.github.io/gitzip/?download=/manoelcampos/padroes-projetos/tree/master/criacionais/singleton/config-singleton-web-cdi[zip])

Este projeto usa o framework de inje√ß√£o de depend√™ncia CDI para implementar um objeto de configura√ß√£o Singleton por meio de uma simples anota√ß√£o `@ApplicationScoped`. Este √© um projeto web desenvolvido com o framework http://quarkus.io[Quarkus]. CDI e Quarkus j√° foram tratados em detalhes no projeto link:https://github.com/manoelcampos/quarkus-cep-services[cep-service].

== Requisitos

== Requisitos

- JDK 8 ou 11
- Maven 3.6.3 ou superior

Mesmo as vers√µes mais atuais do NetBeans v√™m com vers√µes antigas do Maven que n√£o ir√° funcionar.

O maven pode ser instalado, por exemplo em distribui√ß√µes Linux baseadas em Debian, com:

[source,bash]
----
sudo apt-get install maven
----

No Windows, pode-se baixar um arquivo `apache-maven-x.x.x-bin.zip` em https://maven.apache.org/download.cgi. Voc√™ tamb√©m pode configurar o https://docs.microsoft.com/en-us/windows/wsl/install-win10[Windows Subsystem for Linux] e assim poder√° baixar aplica√ß√µes usando o mesmo comando Linux acima.

No NetBeans ent√£o √© poss√≠vel indicar que deseja-se utilizar uma vers√£o do Maven instalada no sistema, no lugar de usar a que vem com o NetBeans. 
Para isto, acesse as prefer√™ncias do NetBeans, depois a aba Java >> Maven e informe o caminho do comando "mvn" no campo "Maven Home".

== Executar o Projeto

Voc√™ pode iniciar o servidor com sua aplica√ß√£o de diferentes maneiras:

- Usando o script mvnw inclu√≠do durante a cria√ß√£o do projeto: `./mvnw compile quarkus:dev`. O comando deve ser executado na raiz do projeto que rodar.
- Ou simplesmente clicando no bot√£o Play em IDEs como o NetBeans, pois foi inclu√≠do o plugin maven exec para executar o comando acima mais facilmente.

==== Atualizando o projeto sem reiniciar o servidor

Bem, atualizar o projeto no servidor em execu√ß√£o e ver as altera√ß√µes que voc√™ fez na sua aplica√ß√£o √© realmente complicado com o Quarkus: voc√™ precisa apenas salvar o projeto e boom: normalmente em menos de 1 segundo a aplica√ß√£o estar√° rodando com as novas altera√ß√µes üò±üöÄüòÅ.

N√£o √© √† toa que o slogan do Quarkus √© "Supersonic Subatomic Java".

==== Acessando a aplica√ß√£o

Se voc√™ estiver habituado a usar servidores como o GlassFish no NetBeans,
sabe que ao clicar no bot√£o Play, o projeto √© compilado e executado,
abrindo o navegador automaticamente.
Usando o Quarkus isso n√£o ocorrer√°.
Voc√™ deve abrir o navegador voc√™ mesmo. Neste caso, a aplica√ß√£o estar√° dispon√≠vel
em http://localhost:8080.
Observe que n√£o h√° um caminho adicional com o nome da aplica√ß√£o no final da URL,
pois a aplica√ß√£o executa na raiz do servidor.

== Detalhes dos Projetos

Estamos utilizando o framework CDI da plataforma Java para inje√ß√£o de depend√™ncias,
neste caso para injetar um inst√¢ncia √∫nica (Singleton) de um objeto
de configura√ß√£o, usando a anota√ß√£o `@ApplicationScoped`.
Desta forma, tal objeto ser√° √∫nico para todos os usu√°rios da aplica√ß√£o.

== Refer√™ncias

- https://quarkus.io/guides/config[Microprofile Config no Quarkus]
- https://quarkus.io/guides/openapi-swaggerui[Documenta√ß√£o de APIs REST com Swagger (OpenAPI) no Quarkus]
- http://weld.cdi-spec.org/documentation/#13[Diferen√ßas entre anota√ß√µes @Singleton e @ApplicationScoped do CDI]
